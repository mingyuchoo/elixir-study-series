---
name: code-analysis
description: 코드 파일을 읽고 분석하여 품질, 버그, 개선점을 체계적으로 리뷰합니다. 사용자가 코드 리뷰, 코드 분석, 버그 검사, 보안 취약점 분석을 요청할 때 사용합니다.
allowed-tools: read_file execute_code
metadata:
  display-name: Code Analysis & Review
  status: active
---

# Skill: Code Analysis & Review

## Purpose

사용자가 코드 파일의 분석이나 리뷰를 요청할 때, 파일을 읽고 체계적으로 분석하여 품질 평가, 잠재적 버그, 개선 제안을 제공합니다.

## Workflow

### Step 1: 코드 파일 읽기 (read_file)

분석할 파일(들)을 읽습니다:

- 단일 파일 또는 여러 파일 지원
- 파일 경로가 없으면 사용자에게 확인 요청

### Step 2: 코드 구조 파악

읽은 코드의 전체 구조를 분석합니다:

- 언어/프레임워크 식별
- 모듈/클래스/함수 구조
- 의존성 관계
- 코드 라인 수 및 복잡도

### Step 3: 정적 분석

다음 관점에서 코드를 분석합니다:

#### 3.1 코드 품질

- 가독성: 변수명, 함수명의 명확성
- 일관성: 코딩 스타일 준수
- 문서화: 주석 및 docstring 품질

#### 3.2 잠재적 버그

- 널/빈 값 처리
- 예외 처리
- 경계 조건 (edge cases)
- 리소스 관리 (메모리, 파일 핸들 등)

#### 3.3 보안 취약점

- 입력 검증
- SQL 인젝션 가능성
- XSS 가능성
- 하드코딩된 민감 정보

#### 3.4 성능

- 비효율적인 알고리즘
- 불필요한 연산/반복
- 메모리 사용 패턴

### Step 4: 동적 분석 (선택적, execute_code)

필요한 경우 테스트 코드를 실행하여 확인:

- 단위 테스트 실행
- 특정 함수 동작 검증
- 성능 측정

### Step 5: 분석 보고서 작성

다음 구조로 분석 결과를 작성합니다:

```markdown
# 코드 분석 보고서

## 파일 정보
- 파일: [파일명]
- 언어: [언어]
- 라인 수: [N]

## 구조 요약
[모듈/함수 구조 다이어그램 또는 목록]

## 품질 평가

### 강점
- [좋은 점 1]
- [좋은 점 2]

### 개선 필요 사항

#### [높음] 심각한 이슈
- **위치**: 라인 N
- **문제**: [설명]
- **해결 방안**: [코드 예시]

#### [중간] 개선 권장
- ...

#### [낮음] 스타일 제안
- ...

## 종합 평가
[별점 또는 점수와 함께 종합 평가]

## 추천 액션
1. [가장 우선적으로 수정할 사항]
2. [다음 단계]
```

## Input Schema

```json
{
  "file_paths": ["분석할 파일 경로들"] (필수),
  "focus": "quality | security | performance | all" (선택, 기본값: all),
  "run_tests": true | false (선택, 기본값: false)
}
```

## Output Format

- 구조화된 마크다운 분석 보고서
- 이슈별 심각도 분류 (높음/중간/낮음)
- 구체적인 개선 코드 예시 포함

## Examples

### Example 1: 단일 파일 리뷰

**사용자 요청**: "lib/my_app/user.ex 파일을 리뷰해줘"

**실행 흐름**:

1. read_file("lib/my_app/user.ex")
2. 구조 분석 (Elixir 모듈, 함수 목록 파악)
3. 품질/버그/보안 관점 분석
4. 분석 보고서 작성

### Example 2: 보안 중심 분석

**사용자 요청**: "이 API 핸들러에 보안 취약점이 있는지 확인해줘"

**실행 흐름**:

1. read_file 로 해당 파일 읽기
2. focus: security 로 보안 관점 집중 분석
   - 입력 검증 확인
   - SQL/명령어 인젝션 가능성
   - 인증/인가 처리
3. 보안 취약점 목록 및 해결 방안 제시

### Example 3: 테스트 포함 분석

**사용자 요청**: "calculator.ex 파일을 분석하고 테스트도 실행해봐"

**실행 흐름**:

1. read_file("lib/calculator.ex")
2. 정적 분석 수행
3. execute_code 로 관련 테스트 실행
4. 테스트 결과 포함 종합 보고서 작성
